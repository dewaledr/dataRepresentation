<html>
    <head>
        <link rel="stylesheet" 
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" 
        crossorigin="anonymous">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <title>View Cars</title>
    </head>
    
    <body onload="getAll()">
        <h1>Cars</h1>
        <button onclick="getAll()">Get All Cars</button>
        <div id="output"></div>
        <table id="carsTable" class="table">
            <tr>
                <th>Reg</th><th>Make</th><th>Model</th><th>Price</th><th></th><th></th>
                <tr></tr><tr></tr><tr></tr><tr></tr><tr></tr><tr></tr>
            </tr>
        </table>
        
    </body>
    <script>
        function addCarToTable(car){
            var tableElement = document.getElementById('carsTable')
            var rowElement = tableElement.insertRow(-1)
            rowElement.setAttribute('id',car.reg)
            var cell1 = rowElement.insertCell(0);
            cell1.innerHTML = car.reg
            var cell2 = rowElement.insertCell(1);
            cell2.innerHTML = car.make
            var cell3 = rowElement.insertCell(2);
            cell3.innerHTML = car.model
            var cell4 = rowElement.insertCell(3);
            cell4.innerHTML = car.price
            var cell5 = rowElement.insertCell(4);
            cell5.innerHTML = '<button onclick="showUpdate(this)">Update</button>'
            var cell6 = rowElement.insertCell(5);
            cell6.innerHTML = '<button onclick=doDelete(this)>delete</button>'
        }

        function getAll(){
            $.ajax({
                "url":      "http://127.0.0.1:5000/cars",
                "method":   "GET",
                "data":     "",
                "dataType": "JSON",
                "success":  function(result){
                    //console.log(JSON.stringify(result));
                    for (car of result.cars){
                        //console.log(car);
                        addCarToTable(car);
                    }
                },
                "error":    function(xhr, status, error){
                    console.log("error: " + status + "Message: " + error);
                }
            });
        }
    </script>
</html>
